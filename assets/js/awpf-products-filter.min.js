/*! advanced-woocommerce-products-filter 2016-03-14 */
function awpf_filter_content_toggle(a){var b=a.currentTarget,c=!!$(b).hasClass("collapsed");c?$(b).removeClass("collapsed"):$(b).addClass("collapsed")}function awpf_subcategories_menu_toggle(a){var b=a.currentTarget,c=$(b).parent(),d=!!c.hasClass("collapsed");d?c.removeClass("collapsed").find("li.has-children").removeClass("collapsed"):c.addClass("collapsed")}function awpf_map_categories_menu(a){var b=a.currentTarget,c=$(b).attr("id").substring(12),d=-1!=c.indexOf("all"),e=d?c.substring(0,c.length-4):c,f=$(b).is(":checked"),g=!1,h=awpf_categories_menu_get_item_parent(e);if(f?(awpf_categories_menu_uncheck_parents(e,h),d&&awpf_categories_menu_uncheck_children(e),h!==!1&&(_AWPF_products_filter_categories[h][e][1]=!0,g=!0)):awpf_categories_menu_is_single_checked_item(e)?$(b).prop("checked",!0):h!==!1&&(_AWPF_products_filter_categories[h][e][1]=!1,g=!0),g){var i=awpf_get_checked_categories();awpf_filter_products_ajax(i)}}function awpf_categories_menu_get_item_parent(a){var b=!1;return $.each(_AWPF_products_filter_categories,function(c,d){return $.each(d,function(d,e){return d==a?(b=c,!1):void 0}),b?!1:void 0}),b}function awpf_categories_menu_uncheck_parents(a,b){b||(b=awpf_categories_menu_get_item_parent(a)),b!==!1&&(awpf_categories_menu_uncheck_item(b),awpf_categories_menu_uncheck_parents(b))}function awpf_categories_menu_uncheck_children(a){$.each(_AWPF_products_filter_categories,function(b,c){b==a&&$.each(c,function(a,c){awpf_categories_menu_uncheck_item(a,b),awpf_categories_menu_uncheck_children(a)})})}function awpf_categories_menu_uncheck_item(a,b){b||(b=awpf_categories_menu_get_item_parent(a)),b!==!1&&(_AWPF_products_filter_categories[b][a][1]=!1),awpf_categories_menu_uncheck_input(a)}function awpf_categories_menu_uncheck_input(a){var b=$(".awpf-category-filter .categories").find("li.cat-"+a);b.length&&(b.hasClass("has-children")?input=b.find("li.cat-"+a+"-all").children("input"):input=b.children("input"),input.length&&input.prop("checked",!1))}function awpf_categories_menu_is_single_checked_item(a){return result=!0,$.each(_AWPF_products_filter_categories,function(b,c){return $.each(c,function(b,c){return c[1]&&b!=a?(result=!1,!1):void 0}),result?void 0:!1}),result}function awpf_get_checked_categories(){var a=[];return $.each(_AWPF_products_filter_categories,function(b,c){$.each(c,function(b,c){c[1]&&a.push(b)})}),a}function awpf_filter_products_ajax(a){if("undefined"!=typeof a&&null!==a){var b=$(".awpf-widget .awpf-loader");b.show(),$.ajax({url:_AWPF_products_filter_ajaxurl,type:"POST",data:{action:"filter_products",taxonomy:"product_cat",term_ids:a,wpml_lang:_AWPF_products_filter_wpml_lang,tax_list:_AWPF_products_filter_tax_list},success:function(a){return a=JSON.parse(a),_AWPF_products_filter_min_price=a.min_price,_AWPF_products_filter_max_price=a.max_price,_AWPF_products_filter_min_handle_price=a.min_handle_price,_AWPF_products_filter_max_handle_price=a.max_handle_price,_AWPF_products_filter_taxonomies=a.taxonomies,_AWPF_products_filter_products=a.products,awpf_display_products_filter(!0),awpf_update_products_grid_ajax(a.products_grid),b.hide(),!0},error:function(a){return b.hide(),!1}})}}function awpf_init_price_slider(a,b,c,d){$("#awpf-price-filter-slider").slider({animate:!0,range:!0,min:a,max:b,values:[c,d],slide:function(a,b){$("#awpf-price-filter-amount").val(_AWPF_products_filter_currency+b.values[0]+" - "+_AWPF_products_filter_currency+b.values[1])},change:function(a,b){awpf_price_slider_change(b.values[0],b.values[1])}}),$("#awpf-price-filter-amount").val(_AWPF_products_filter_currency+$("#awpf-price-filter-slider").slider("values",0)+" - "+_AWPF_products_filter_currency+$("#awpf-price-filter-slider").slider("values",1))}function awpf_price_slider_change(a,b){_AWPF_products_filter_min_handle_price=a,_AWPF_products_filter_max_handle_price=b,awpf_filter_products()}function awpf_map_taxonomy_terms(){var a=$(".awpf-tax-filter");a.each(function(){var a=$(this).attr("class").split(/\s+/),b=$(this).find(".tax-terms");tax_name="",$.each(a,function(a,b){b.indexOf("awpf-tax-filter-")>=0&&(tax_name=b.substring(16))}),b.find("input").each(function(){var a=$(this).attr("id");_AWPF_products_filter_taxonomies[tax_name][2][a][1]=$(this).is(":checked")?1:0})}),awpf_filter_products()}function awpf_filter_products(){return awpf_update_products_filter(),awpf_update_products_grid(),!0}function awpf_update_products_filter(){_AWPF_products_filter_min_price=null,_AWPF_products_filter_max_price=null,$.each(_AWPF_products_filter_taxonomies,function(a,b){b[1]=0,$.each(b[2],function(a,b){b[0]=0})}),$.each(_AWPF_products_filter_products,function(a,b){if(b[1]=1,$.each(_AWPF_products_filter_taxonomies,function(a,c){return $.each(c[2],function(c,d){return d[1]&&-1==$.inArray(parseInt(c),b[2][a])?(b[1]=0,!1):void 0}),b[1]?void 0:!1}),!b[1])return!0;var c=b[0];return _AWPF_products_filter_min_price&&_AWPF_products_filter_max_price?(_AWPF_products_filter_min_price=c<_AWPF_products_filter_min_price?c:_AWPF_products_filter_min_price,_AWPF_products_filter_max_price=c>_AWPF_products_filter_max_price?c:_AWPF_products_filter_max_price):_AWPF_products_filter_min_price=_AWPF_products_filter_max_price=c,c<_AWPF_products_filter_min_handle_price||c>_AWPF_products_filter_max_handle_price?(b[1]=0,!0):void $.each(b[2],function(a,b){b.length>0&&(_AWPF_products_filter_taxonomies[a][1]++,$.each(b,function(b,c){_AWPF_products_filter_taxonomies[a][2][c][0]++}))})}),awpf_display_products_filter()}function awpf_display_products_filter(a){_AWPF_products_filter_show_price_filter&&(min_handle_price=_AWPF_products_filter_min_price&&_AWPF_products_filter_min_handle_price<_AWPF_products_filter_min_price?_AWPF_products_filter_min_price:_AWPF_products_filter_min_handle_price,max_handle_price=_AWPF_products_filter_max_price&&_AWPF_products_filter_max_handle_price>_AWPF_products_filter_max_price?_AWPF_products_filter_max_price:_AWPF_products_filter_max_handle_price,(_AWPF_products_filter_price_filter_init||_AWPF_products_filter_min_price!=_AWPF_products_filter_max_price)&&(_AWPF_products_filter_price_filter_init?$("#awpf-price-filter-slider").slider("destroy"):($(".awpf-price-filter").show(),_AWPF_products_filter_price_filter_init=!0),awpf_init_price_slider(_AWPF_products_filter_min_price,_AWPF_products_filter_max_price,min_handle_price,max_handle_price))),$.each(_AWPF_products_filter_taxonomies,function(b,c){0==c[1]?$(".awpf-tax-filter-"+b).hide():($(".awpf-tax-filter-"+b).show(),$.each(c[2],function(b,c){if(0==c[0])$(".awpf-tax-filter input#"+b).parent("li").hide();else{var d=$(".awpf-tax-filter input#"+b);d.parent("li").find("span.count").html(c[0]),a&&d.prop("checked",!1),d.parent("li").show()}}))})}function awpf_update_products_grid(){var a=0;$(".awpf-not-found").hide(),$("ul.products li").hide(),$("ul.products li").each(function(b){var c=$(this).attr("class"),d=c.match(/post-(\d+)/g),e=parseInt(d[0].substring(5));_AWPF_products_filter_products[e][1]&&($(this).show(),a++)}),a||$(".awpf-not-found").show()}function awpf_update_products_grid_ajax(a){$("ul.products").html(a),$("ul.products > li").addClass("product")}jQuery(function(a){a(".awpf-filter-title").bind("click",awpf_filter_content_toggle),a(".awpf-filter").first().children(".awpf-filter-title").addClass("collapsed");var b='<div class="awpf-not-found" style="display: none;">'+_AWPF_products_filter_not_found+"</div>";a("ul.products").after(b),_AWPF_products_filter_show_categories_menu&&(a(".awpf-category-filter li.has-children > .item-before").bind("click",awpf_subcategories_menu_toggle),a(".awpf-category-filter li.has-children > a").bind("click",awpf_subcategories_menu_toggle),a(".awpf-category-filter input").bind("change",awpf_map_categories_menu)),_AWPF_products_filter_show_price_filter&&(_AWPF_products_filter_price_filter_init=!1,_AWPF_products_filter_min_price!=_AWPF_products_filter_max_price?(awpf_init_price_slider(_AWPF_products_filter_min_price,_AWPF_products_filter_max_price,_AWPF_products_filter_min_handle_price,_AWPF_products_filter_max_handle_price),_AWPF_products_filter_price_filter_init=!0):a(".awpf-price-filter").hide()),a(".awpf-tax-filter .tax-terms input").bind("change",awpf_map_taxonomy_terms)});